<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mortgage Affordability Calculator ‚Äî Jonathan Parker | Triangle Families</title>
    <meta name="description" content="Find out how much house you can afford in Wake County, NC using your budget, current mortgage rates, and local property taxes.">
    <link rel="stylesheet" href="styles.css">
    <style>
        .rate-pill { display: inline-flex; align-items: center; gap: 8px; padding: 8px 14px; border-radius: 40px; background: rgba(34,197,94,0.12); color: #16a34a; font-size: 0.88rem; font-weight: 600; margin-bottom: 1rem; }
        .layout-grid { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 2rem; }
        @media (max-width: 768px) { .layout-grid { grid-template-columns: 1fr; } }
        .how-it-works li { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed var(--border); font-size: 0.9rem; color: var(--text-light); }
        .results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1.25rem 0; }
        .result-stat { background: var(--bg); padding: 1.25rem; border-radius: var(--radius); border: 1px solid var(--border); text-align: center; }
        .result-stat .label { font-size: 0.78rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-lighter); font-weight: 600; }
        .result-stat .value { font-size: 1.5rem; font-weight: 800; color: var(--primary); margin-top: 0.25rem; }
        .breakdown-list { list-style: none; margin: 1rem 0; }
        .breakdown-list li { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border); font-size: 0.92rem; }
    </style>
</head>
<body>
    <nav class="site-nav"><div class="nav-inner">
        <a href="index.html" class="nav-brand"><span class="nav-brand-name">Jonathan Parker</span><span class="nav-brand-tag">Financial Educator ¬∑ Triangle NC</span></a>
        <input type="checkbox" id="nav-toggle" class="nav-toggle" hidden><label for="nav-toggle" class="nav-toggle-label"><span></span></label>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li><li><a href="index.html#calculators" class="active">Calculators</a></li>
            <li><a href="index.html#blog">Blog</a></li><li><a href="index.html#about">About</a></li>
            <li><a href="https://scheduler.zoom.us/jonathan-parker-i9rj3o/pfs-intro" target="_blank" rel="noopener" class="nav-cta">Book a Call</a></li>
        </ul>
    </div></nav>

    <div class="calc-page-hero">
        <div class="container">
            <h1>üè† Wake County Home Affordability</h1>
            <p>Start with your monthly budget, work backward to find your target home price</p>
        </div>
    </div>

    <div class="calc-container" style="max-width:1000px;">
        <div class="calc-card">
            <div class="layout-grid">
                <div>
                    <div class="rate-pill" id="rateStatus">Loading current mortgage rate‚Ä¶</div>
                    <h3 style="margin-bottom:1rem;">Your Monthly Housing Budget</h3>
                    <form id="affordabilityForm">
                        <div class="form-group">
                            <label for="monthlyBudget">Target Total Monthly Payment</label>
                            <input type="text" id="monthlyBudget" inputmode="decimal" placeholder="$2,400" required>
                            <small style="color:var(--text-light);">Includes mortgage, taxes, insurance, and HOA</small>
                        </div>
                        <div class="form-group">
                            <label for="downPayment">Down Payment (%)</label>
                            <input type="text" id="downPayment" inputmode="decimal" value="12">
                        </div>
                        <div class="form-group">
                            <label for="loanTerm">Loan Term</label>
                            <select id="loanTerm">
                                <option value="30">30-Year Fixed</option>
                                <option value="20">20-Year Fixed</option>
                                <option value="15">15-Year Fixed</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="interestRate">Mortgage Rate (%)</label>
                            <input type="text" id="interestRate" inputmode="decimal" value="6.50">
                            <small style="color:var(--text-light);">Auto-filled with latest average; editable</small>
                        </div>
                        <div class="form-group">
                            <label for="taxRate">Wake County Property Tax (%)</label>
                            <input type="text" id="taxRate" inputmode="decimal" value="0.87">
                            <small style="color:var(--text-light);">County + Raleigh rate FY2024-25</small>
                        </div>
                        <div class="form-group">
                            <label for="insuranceMonthly">Homeowner's Insurance (monthly)</label>
                            <input type="text" id="insuranceMonthly" inputmode="decimal" value="135">
                        </div>
                        <div class="form-group">
                            <label for="hoaFees">HOA / Other Monthly Fees</label>
                            <input type="text" id="hoaFees" inputmode="decimal" value="0">
                        </div>
                        <button type="submit" class="btn btn-primary btn-block btn-lg">Calculate Affordability</button>
                        <p id="formError" style="display:none; color:#dc2626; margin-top:0.5rem; font-size:0.9rem;"></p>
                    </form>
                </div>
                <div>
                    <h3 style="margin-bottom:1rem;">How This Works</h3>
                    <ul class="how-it-works">
                        <li><span>1. Start with your total monthly housing budget</span></li>
                        <li><span>2. Subtract taxes, insurance, and HOA</span></li>
                        <li><span>3. Solve the mortgage formula backward</span></li>
                        <li><span>4. Show cash needed upfront</span></li>
                    </ul>
                    <div class="disclaimer-box" style="margin-top:1.5rem;">
                        <strong>üí° Tip:</strong> Keep total housing at 30-33% of take-home pay. Use alongside your emergency fund and other debts to decide if the payment feels safe.
                    </div>
                    <p style="font-size:0.82rem; color:var(--text-lighter); margin-top:1rem;">Property tax: Wake County FY2024-25 (0.5171 county + 0.3550 Raleigh). Insurance: ~$1,620/year average.</p>
                </div>
            </div>

            <div id="results" style="display:none; margin-top:2rem; padding-top:2rem; border-top:2px solid var(--border);">
                <h2 style="font-size:1.5rem; font-weight:800; margin-bottom:0.5rem;">Your Wake County Target</h2>
                <p id="resultsSummary" style="color:var(--text-light); margin-bottom:1rem;"></p>
                <div class="results-grid">
                    <div class="result-stat"><div class="label">Home Price</div><div class="value" id="homePrice">$0</div></div>
                    <div class="result-stat"><div class="label">Loan Amount</div><div class="value" id="loanAmount">$0</div></div>
                    <div class="result-stat"><div class="label">Cash to Close*</div><div class="value" id="cashNeeded">$0</div></div>
                    <div class="result-stat"><div class="label">Payment Cushion</div><div class="value" id="paymentGap">$0</div></div>
                </div>
                <div style="background:var(--bg); padding:1.25rem; border-radius:var(--radius); border:1px solid var(--border); margin-top:1rem;">
                    <div style="font-weight:600; margin-bottom:0.5rem;">Monthly Payment Breakdown</div>
                    <ul class="breakdown-list" id="paymentBreakdown"></ul>
                </div>
                <div class="disclaimer-box" style="margin-top:1rem;">
                    *Cash to close = down payment + ~3% closing costs (lender fees, escrow, appraisal, etc.). Confirm with your lender.
                </div>
                <div style="text-align:center; margin-top:1.5rem;">
                    <a href="https://scheduler.zoom.us/jonathan-parker-i9rj3o/pfs-intro" target="_blank" rel="noopener" class="btn btn-primary">üìÖ Let's Talk Home Buying</a>
                </div>

                <div style="background:linear-gradient(135deg,var(--primary),var(--primary-light));color:white;padding:2rem;border-radius:var(--radius-lg);text-align:center;margin-top:1.5rem;">
                    <h4 style="margin-bottom:0.75rem;font-size:1.15rem;">üìù Get Your Affordability Report</h4>
                    <p style="opacity:0.9;margin-bottom:1rem;font-size:0.92rem;">Receive a detailed breakdown with cash-to-close estimates and next steps.</p>
                    <div id="mtgEmailStatus" style="display:none;background:var(--accent);color:white;padding:1rem;border-radius:var(--radius);margin-bottom:1rem;text-align:center;font-weight:700;">‚úÖ Report sent! Check your email.</div>
                    <form id="mtgEmailForm" style="display:flex;gap:0.75rem;max-width:450px;margin:0 auto;flex-wrap:wrap;">
                        <input type="email" id="mtgEmail" placeholder="Your email address" required style="flex:1;min-width:200px;padding:0.75rem;border:none;border-radius:var(--radius);font-size:1rem;">
                        <button type="submit" style="background:var(--accent);color:white;border:none;padding:0.75rem 1.5rem;border-radius:var(--radius);font-weight:700;cursor:pointer;white-space:nowrap;">Send My Report üìß</button>
                    </form>
                    <p style="font-size:0.78rem;margin-top:0.5rem;opacity:0.75;">Your info is secure and never shared.</p>
                </div>
            </div>
        </div>
    </div>

    <footer class="site-footer"><div class="container"><div class="footer-grid">
        <div class="footer-section"><h4>Calculators</h4><ul>
            <li><a href="insurance-calculator.html">Life Insurance</a></li><li><a href="retirement-planning-calculator.html">Retirement Planning</a></li>
            <li><a href="college-savings-calculator.html">College Savings</a></li><li><a href="debt-payoff-calculator.html">Debt Payoff</a></li>
            <li><a href="mortgage-calculator.html">Mortgage Affordability</a></li><li><a href="emergency-fund-calculator.html">Emergency Fund</a></li>
        </ul></div>
        <div class="footer-section"><h4>Resources</h4><ul>
            <li><a href="https://therealhowmoneyworks.com/us/Jonathan_Parker" target="_blank" rel="noopener">Financial Planning Guide</a></li>
            <li><a href="21-sources-of-cash.html">21 Sources of Cash Workshop</a></li>
        </ul></div>
        <div class="footer-section"><h4>Contact</h4><ul>
            <li><a href="mailto:jlparker0106@gmail.com">‚úâÔ∏è jlparker0106@gmail.com</a></li>
            <li><a href="https://scheduler.zoom.us/jonathan-parker-i9rj3o/pfs-intro" target="_blank" rel="noopener">üìÖ Schedule a Consultation</a></li>
            <li class="footer-contact-item">üìç Serving the NC Triangle</li>
        </ul></div>
        <div class="footer-section"><h4>Connect</h4><ul>
            <li><a href="https://www.facebook.com/jplarkin/" target="_blank" rel="noopener">Facebook</a></li>
            <li><a href="https://www.linkedin.com/in/jonathan-parker-026b9511a" target="_blank" rel="noopener">LinkedIn</a></li>
        </ul></div>
    </div><div class="footer-bottom">
        <p>&copy; 2026 Jonathan Parker Financial Services. All rights reserved.</p>
        <p>Licensed in North Carolina ¬∑ Not affiliated with any government agency</p>
    </div></div></footer>

    <a href="https://scheduler.zoom.us/jonathan-parker-i9rj3o/pfs-intro" target="_blank" rel="noopener" class="floating-cta">
        üìÖ <span class="cta-text-full">Book a Free Call</span><span class="cta-text-short">Book Call</span>
    </a>

    <script>
        const RATE_ENDPOINT = 'https://raw.githubusercontent.com/gustavbotty-max/Parker/main/data/mortgage-rate.json';
        const FALLBACK_RATE = 6.50;
        const currency = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 });
        const preciseCurrency = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2, maximumFractionDigits: 2 });

        const rateStatusEl = document.getElementById('rateStatus');
        const interestRateEl = document.getElementById('interestRate');

        async function loadMortgageRate() {
            interestRateEl.value = FALLBACK_RATE.toFixed(2);
            try {
                const response = await fetch(RATE_ENDPOINT);
                if (!response.ok) throw new Error('Rate source unavailable');
                const data = await response.json();
                if (data?.thirty_year_fixed) {
                    interestRateEl.value = Number(data.thirty_year_fixed).toFixed(3);
                    rateStatusEl.textContent = `Auto rate: ${Number(data.thirty_year_fixed).toFixed(3)}% (source: ${data.source || 'external'})`;
                } else { rateStatusEl.textContent = 'Using fallback rate'; }
            } catch { rateStatusEl.textContent = 'Rate feed unavailable ‚Äî using fallback'; }
        }

        function toNumber(v) { return parseFloat(String(v || '').replace(/[$,%\s,]/g, '')) || 0; }

        function mortgagePayment(principal, monthlyRate, months) {
            if (principal <= 0) return 0;
            if (monthlyRate === 0) return principal / months;
            return (principal * monthlyRate) / (1 - Math.pow(1 + monthlyRate, -months));
        }

        function solveHomePrice(target, inputs) {
            const { monthlyRate, termMonths, downPct, taxRate, insurance, hoa } = inputs;
            const pay = p => {
                const loan = p * (1 - downPct);
                return mortgagePayment(loan, monthlyRate, termMonths) + p * taxRate / 12 + insurance + hoa;
            };
            let lo = 10000, hi = 200000;
            while (pay(lo) > target && lo > 1000) lo *= 0.7;
            if (pay(lo) > target) return null;
            while (pay(hi) < target && hi < 8000000) hi *= 1.6;
            let best = lo;
            for (let i = 0; i < 60; i++) {
                const mid = (lo + hi) / 2;
                if (Math.abs(pay(mid) - target) < 1) { best = mid; break; }
                if (pay(mid) > target) hi = mid; else { lo = mid; best = mid; }
            }
            return { price: best, payment: pay(best) };
        }

        document.getElementById('affordabilityForm').addEventListener('submit', e => {
            e.preventDefault();
            const errEl = document.getElementById('formError');
            errEl.style.display = 'none';

            const budget = toNumber(document.getElementById('monthlyBudget').value);
            const downPct = toNumber(document.getElementById('downPayment').value) / 100;
            const termYears = parseInt(document.getElementById('loanTerm').value);
            const rate = toNumber(interestRateEl.value) / 100;
            const taxRate = toNumber(document.getElementById('taxRate').value) / 100;
            const insurance = toNumber(document.getElementById('insuranceMonthly').value);
            const hoa = toNumber(document.getElementById('hoaFees').value);

            if (budget <= 0 || rate < 0 || downPct >= 1) {
                errEl.textContent = 'Please check your inputs.'; errEl.style.display = 'block'; return;
            }

            const sol = solveHomePrice(budget, { monthlyRate: rate / 12, termMonths: termYears * 12, downPct, taxRate, insurance, hoa });
            if (!sol) { errEl.textContent = 'Budget too low for these assumptions.'; errEl.style.display = 'block'; return; }

            const hp = Math.round(sol.price);
            const loan = hp * (1 - downPct);
            const pi = mortgagePayment(loan, rate / 12, termYears * 12);
            const tax = hp * taxRate / 12;
            const total = pi + tax + insurance + hoa;
            const gap = budget - total;
            const cash = hp * downPct + hp * 0.03;

            document.getElementById('homePrice').textContent = currency.format(hp);
            document.getElementById('loanAmount').textContent = currency.format(loan);
            document.getElementById('cashNeeded').textContent = currency.format(cash);
            document.getElementById('paymentGap').textContent = `${gap >= 0 ? '+' : '-'}${currency.format(Math.abs(gap))}`;

            const bl = document.getElementById('paymentBreakdown');
            bl.innerHTML = '';
            [{ l: 'Principal & Interest', v: pi }, { l: 'Property Taxes', v: tax }, { l: "Homeowner's Insurance", v: insurance }, { l: 'HOA / Other', v: hoa }].forEach(i => {
                const li = document.createElement('li');
                li.innerHTML = `<span>${i.l}</span><span>${preciseCurrency.format(i.v)}</span>`;
                bl.appendChild(li);
            });

            document.getElementById('resultsSummary').textContent = `With a $${budget.toLocaleString()} budget, ${(downPct*100).toFixed(1)}% down, ${termYears}-yr fixed at ${(rate*100).toFixed(3)}%, you're looking at ~${currency.format(hp)}.`;
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        });

        document.getElementById('mtgEmailForm').addEventListener('submit', function(e) {
            e.preventDefault();
            var email = document.getElementById('mtgEmail').value;
            if (!email) return;
            var btn = this.querySelector('button');
            btn.textContent = 'Sending...'; btn.disabled = true;
            fetch('https://formspree.io/f/xkovojay', {
                method: 'POST', headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                body: JSON.stringify({ email: email, calculator_type: 'mortgage-affordability', lead_source: 'calculator-results', timestamp: new Date().toISOString() })
            }).then(function(r){return r.json()}).then(function(d){ if(d.ok){ document.getElementById('mtgEmailStatus').style.display='block'; btn.textContent='‚úÖ Sent!'; } else { alert('Error ‚Äî try again.'); btn.textContent='Send My Report üìß'; btn.disabled=false; }}).catch(function(){ alert('Connection error.'); btn.textContent='Send My Report üìß'; btn.disabled=false; });
        });

        loadMortgageRate();
    </script>
</body>
</html>
